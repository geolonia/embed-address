!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";(function(t){var o=n(3),r=n(4),a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,l=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function s(e){return(e||"").toString().replace(l,"")}var c=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],u={hash:1,query:1};function d(e){var n,o=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},r={},i=typeof(e=e||o);if("blob:"===e.protocol)r=new f(unescape(e.pathname),{});else if("string"===i)for(n in r=new f(e,{}),u)delete r[n];else if("object"===i){for(n in e)n in u||(r[n]=e[n]);void 0===r.slashes&&(r.slashes=a.test(e.href))}return r}function p(e){e=s(e);var t=i.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function f(e,t,n){if(e=s(e),!(this instanceof f))return new f(e,t,n);var a,i,l,u,m,h,y=c.slice(),g=typeof t,v=this,b=0;for("object"!==g&&"string"!==g&&(n=t,t=null),n&&"function"!=typeof n&&(n=r.parse),t=d(t),a=!(i=p(e||"")).protocol&&!i.slashes,v.slashes=i.slashes||a&&t.slashes,v.protocol=i.protocol||t.protocol||"",e=i.rest,i.slashes||(y[3]=[/(.*)/,"pathname"]);b<y.length;b++)"function"!=typeof(u=y[b])?(l=u[0],h=u[1],l!=l?v[h]=e:"string"==typeof l?~(m=e.indexOf(l))&&("number"==typeof u[2]?(v[h]=e.slice(0,m),e=e.slice(m+u[2])):(v[h]=e.slice(m),e=e.slice(0,m))):(m=l.exec(e))&&(v[h]=m[1],e=e.slice(0,m.index)),v[h]=v[h]||a&&u[3]&&t[h]||"",u[4]&&(v[h]=v[h].toLowerCase())):e=u(e);n&&(v.query=n(v.query)),a&&t.slashes&&"/"!==v.pathname.charAt(0)&&(""!==v.pathname||""!==t.pathname)&&(v.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),o=n.length,r=n[o-1],a=!1,i=0;o--;)"."===n[o]?n.splice(o,1):".."===n[o]?(n.splice(o,1),i++):i&&(0===o&&(a=!0),n.splice(o,1),i--);return a&&n.unshift(""),"."!==r&&".."!==r||n.push(""),n.join("/")}(v.pathname,t.pathname)),o(v.port,v.protocol)||(v.host=v.hostname,v.port=""),v.username=v.password="",v.auth&&(u=v.auth.split(":"),v.username=u[0]||"",v.password=u[1]||""),v.origin=v.protocol&&v.host&&"file:"!==v.protocol?v.protocol+"//"+v.host:"null",v.href=v.toString()}f.prototype={set:function(e,t,n){var a=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||r.parse)(t)),a[e]=t;break;case"port":a[e]=t,o(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="");break;case"hostname":a[e]=t,a.port&&(t+=":"+a.port),a.host=t;break;case"host":a[e]=t,/:\d+$/.test(t)?(t=t.split(":"),a.port=t.pop(),a.hostname=t.join(":")):(a.hostname=t,a.port="");break;case"protocol":a.protocol=t.toLowerCase(),a.slashes=!n;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";a[e]=t.charAt(0)!==i?i+t:t}else a[e]=t;break;default:a[e]=t}for(var l=0;l<c.length;l++){var s=c[l];s[4]&&(a[s[1]]=a[s[1]].toLowerCase())}return a.origin=a.protocol&&a.host&&"file:"!==a.protocol?a.protocol+"//"+a.host:"null",a.href=a.toString(),a},toString:function(e){e&&"function"==typeof e||(e=r.stringify);var t,n=this,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var a=o+(n.slashes?"//":"");return n.username&&(a+=n.username,n.password&&(a+=":"+n.password),a+="@"),a+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(a+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(a+=n.hash),a}},f.extractProtocol=p,f.location=d,f.trimLeft=s,f.qs=r,e.exports=f}).call(this,n(2))},function(e,t,n){"use strict";t.decode=t.parse=n(5),t.encode=t.stringify=n(6)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,n){"use strict";var o=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function a(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,r,i=[];for(r in"string"!=typeof t&&(t="?"),e)if(o.call(e,r)){if((n=e[r])||null!=n&&!isNaN(n)||(n=""),r=a(r),n=a(n),null===r||null===n)continue;i.push(r+"="+n)}return i.length?t+i.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,o={};t=n.exec(e);){var a=r(t[1]),i=r(t[2]);null===a||null===i||a in o||(o[a]=i)}return o}},function(e,t,n){"use strict";function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var l=/\+/g;e=e.split(t);var s=1e3;a&&"number"==typeof a.maxKeys&&(s=a.maxKeys);var c=e.length;s>0&&c>s&&(c=s);for(var u=0;u<c;++u){var d,p,f,m,h=e[u].replace(l,"%20"),y=h.indexOf(n);y>=0?(d=h.substr(0,y),p=h.substr(y+1)):(d=h,p=""),f=decodeURIComponent(d),m=decodeURIComponent(p),o(i,f)?r(i[f])?i[f].push(m):i[f]=[i[f],m]:i[f]=m}return i};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,l){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?a(i(e),(function(i){var l=encodeURIComponent(o(i))+n;return r(e[i])?a(e[i],(function(e){return l+encodeURIComponent(o(e))})).join(t):l+encodeURIComponent(o(e[i]))})).join(t):l?encodeURIComponent(o(l))+n+encodeURIComponent(o(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var n=[],o=0;o<e.length;o++)n.push(t(e[o],o));return n}var i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";n.r(t);const o=(e,t,n,o)=>new Promise(r=>{t.forEach(t=>{const r=document.createElement("option");r.value=t[n],r.innerText=t[o],r.className="geolonia_address_"+e.name,e.appendChild(r)}),e.disabled=!1,r()}),r=(e,t,n)=>new Promise(o=>{t.forEach(t=>{const o=document.createElement("option");o.value=t[n],e.appendChild(o)}),o()}),a=e=>new Promise(t=>{[...e.children].forEach(e=>{const t=e;"true"!==(t.dataset||{}).isPlaceholder?t.remove():t.selected=!0}),t()}),i=(e,t)=>{e.className+=(e.className?" ":"")+"geolonia_address_wrap";e.innerHTML+=`\n    <button\n      id="geolonia-reverse-geocode-button"\n      type="button"\n    >${t.geolocationButtonLabel}</button>\n\n    <select\n      id="geolonia-pref-code"\n      name="${t.prefCodeName}"\n      class="geolonia_pref_select"\n      disabled\n    >\n      <option\n        data-is-placeholder="true"\n        selected\n        disabled\n      >${t.prefectureLabel}</option>\n    </select>\n\n    <input\n      id="geolonia-prefecture-name"\n      name="${t.prefectureName}"\n      type="hidden"\n    />\n\n    <select\n      id="geolonia-city-code"\n      name="${t.cityCodeName}"\n      class="geolonia_city_select"\n      disabled\n    >\n      <option\n        data-is-placeholder="true"\n        selected\n        disabled\n      >${t.cityLabel}</option>\n    </select>\n\n    <input\n      id="geolonia-city-name"\n      name="${t.cityName}"\n      type="hidden"\n    />\n\n    <input\n      id="geolonia-small-area"\n      name="${t.smallAreaName}"\n      class="geolonia_small_area_input"\n      type="text"\n      list="geolonia-small-area-datalist"\n      placeholder="${t.smallAreaLabel}"\n    />\n\n    <datalist id="geolonia-small-area-datalist"></datalist>\n\n    <input\n      id=geolonia-small-area-is-exception\n      name="${t.isSmallAreaExceptionName}"\n      type="hidden"\n    />\n\n    <input\n      id="geolonia-other-address"\n      name="${t.otherAddressName}"\n      class="geolonia_ither_address_input"\n      type="text"\n      placeholder="${t.otherAddressLabel}"\n    />\n\n    <div class="geolonia_error">\n      <span id="geolonia-error-message" />\n    </div>\n  `;const n=document.getElementById("geolonia-reverse-geocode-button"),o=document.querySelector("#geolonia-pref-code"),r=document.querySelector("#geolonia-prefecture-name"),a=document.querySelector("#geolonia-city-code"),i=document.querySelector("#geolonia-city-name"),l=document.querySelector("#geolonia-small-area"),s=document.querySelector("#geolonia-small-area-datalist"),c=document.querySelector("#geolonia-small-area-is-exception"),u=document.querySelector("#geolonia-other-address"),d=document.querySelector("#geolonia-error-message"),p=e.closest("form");return o.addEventListener("change",e=>{if(e.target instanceof HTMLSelectElement){d.innerText="";const t=e.target.value,n=[...document.querySelectorAll("#geolonia-pref-code option")].find(e=>e.value===t);n&&(r.value=n.innerText)}}),a.addEventListener("change",e=>{if(e.target instanceof HTMLSelectElement){d.innerText="";const t=e.target.value,n=[...document.querySelectorAll("#geolonia-city-code option")].find(e=>e.value===t);n&&(i.value=n.innerText)}}),l.addEventListener("change",e=>{if(e.target instanceof HTMLInputElement){d.innerText="";const t=e.target.value,n=[...document.querySelectorAll("#geolonia-small-area-datalist option")].find(e=>e.value===t);c.value=n?"false":"true"}}),u.addEventListener("change",e=>{d.innerText=""}),{buttonGeolocation:n,selectPrefCode:o,inputPrefName:r,selectCityCode:a,inputCityName:i,inputSmallArea:l,datalistSmallArea:s,inputIsSmallAreaException:c,spanErrorMessage:d,parentalForm:p}};var l=n(0),s=n.n(l),c=n(1),u=n.n(c);const d={geolocationButtonLabel:"現在地から住所を入力",geolocatingLabel:"取得中...",prefectureLabel:"都道府県",cityLabel:"市区町村",smallAreaLabel:"大字町丁目",otherAddressLabel:"その他の住所",prefectureName:"prefecture",prefCodeName:"pref-code",cityName:"city",cityCodeName:"city-code",smallAreaName:"small-area",isSmallAreaExceptionName:"is-exception",otherAddressName:"other-address"};var p=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}))};const f=e=>p(void 0,void 0,void 0,(function*(){try{return yield fetch("https://cdn.geolonia.com/address/"+e).then(e=>{if(e.status>299)throw console.error(e),new Error("request error");return e.json()})}catch(e){return null}})),m=e=>f(`japan/${e}.json`),h=(e,t)=>f(`japan/${e}/${t}.json`);var y=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}))};const g=e=>y(void 0,void 0,void 0,(function*(){const t=(e=>{let t;if(t=e instanceof HTMLElement?e:document.getElementById(e),!t)throw new Error("no target found.");return t})(e),n=(e=>{const t=e.dataset||{},n=Object.keys(t).reduce((e,n)=>(e[n]=escape(t[n]),e),{});return Object.assign(Object.assign({},d),n)})(t);let l=NaN,c=NaN,g="",v="";const[b,x]=yield Promise.all([i(t,n),f("japan.json")]),{buttonGeolocation:w,selectPrefCode:N,inputPrefName:A,selectCityCode:E,inputCityName:S,inputSmallArea:L,datalistSmallArea:j,inputIsSmallAreaException:C,spanErrorMessage:T,parentalForm:P}=b;if(!x)return void(T.innerText="何かのエラーです。住所データを取得できませんでした。");yield o(N,x,"都道府県コード","都道府県名"),w.addEventListener("click",()=>y(void 0,void 0,void 0,(function*(){w.innerText=n.geolocatingLabel;try{const e=yield new Promise((e,t)=>{window.navigator.geolocation.getCurrentPosition(t=>{const{latitude:n,longitude:o}=t.coords;e({lat:n,lng:o})},e=>t(e))});l=e.lat,c=e.lng}catch(e){return console.error(e),w.innerText=n.geolocationButtonLabel,void(T.innerText="現在位置から住所を取得できませんでした。")}const e=yield((e,t)=>p(void 0,void 0,void 0,(function*(){try{return yield fetch(`https://api.geolonia.com/dev/reverseGeocode?lng=${e}&lat=${t}`).then(e=>{if(e.status>299)throw console.error(e),new Error("request error");return e.json()})}catch(e){return null}})))(c,l);if(!e)return w.innerText=n.geolocationButtonLabel,void(T.innerText="何かのエラーです。現在位置から住所を取得できませんでした。");T.innerText="";const{PREF:t,CITY:i,S_NAME:s}=e;g=t,v=t+i;const[u,d]=yield Promise.all([m(g),h(g,v)]);if(!u||!d)return w.innerText=n.geolocationButtonLabel,void(T.innerText="何かのエラーです。住所データを取得できませんでした。");const f=x.find(e=>e.都道府県コード===g),y=u.find(e=>e.市区町村コード===v);f&&(A.value=f.都道府県名),y&&(S.value=y.市区町村名),yield Promise.all([a(E),a(j)]),yield Promise.all([o(E,u,"市区町村コード","市区町村名"),r(j,d,"大字町丁目名")]),N.value=g,E.value=v,L.value=s||"",C.value=d.find(e=>e.大字町丁目名===s)?"false":"true",w.innerText=n.geolocationButtonLabel})));N.addEventListener("change",e=>y(void 0,void 0,void 0,(function*(){if(e.target instanceof HTMLSelectElement){g=e.target.value;const t=yield m(g);if(!t)return void(T.innerText="何かのエラーです。住所データを取得できませんでした。");yield Promise.all([a(E),a(j)]),yield o(E,t,"市区町村コード","市区町村名")}}))),E.addEventListener("change",e=>y(void 0,void 0,void 0,(function*(){if(e.target instanceof HTMLSelectElement){v=e.target.value;const t=yield h(g,v);if(!t)return void(T.innerText="何かのエラーです。住所データを取得できませんでした。");yield a(j),yield r(j,t,"大字町丁目名")}}))),P&&P.addEventListener("submit",e=>{if(e.target instanceof HTMLFormElement&&!Number.isNaN(l)&&!Number.isNaN(c)){const t=new FormData(e.target),o=((e=window.document)=>{const t=e.getElementsByTagName("script");let n="YOUR-API-KEY";for(const e of t){const t=s()(e.src).query,o=u.a.parse(t.replace(/^\?/,""));if(o["geolonia-api-key"]&&"string"==typeof o["geolonia-api-key"]){n=o["geolonia-api-key"]||n;break}}return n})();(({formData:e,lat:t,lng:n,apiKey:o},r)=>{const a=JSON.stringify({[d.prefCodeName]:e.get(r.prefCodeName),[d.prefectureName]:e.get(r.prefectureName),[d.cityName]:e.get(r.cityName),[d.cityCodeName]:e.get(r.cityCodeName),[d.smallAreaName]:e.get(r.smallAreaName),[d.otherAddressName]:e.get(r.otherAddressName),[d.isSmallAreaExceptionName]:e.get(r.isSmallAreaExceptionName),lat:t,lng:n});fetch("./",{method:"POST",headers:{"x-geolonia-api-key":o},body:a})})({formData:t,lat:l,lng:c,apiKey:o},n)}})})),v=document.getElementById("address");v&&g(v),window.geolonia||(window.geolonia={}),window.geolonia.address=g}]);