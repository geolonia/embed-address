!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";(function(t){var o=n(2),r=n(3),a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,l=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function s(e){return(e||"").toString().replace(l,"")}var c=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],u={hash:1,query:1};function d(e){var n,o=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},r={},i=typeof(e=e||o);if("blob:"===e.protocol)r=new f(unescape(e.pathname),{});else if("string"===i)for(n in r=new f(e,{}),u)delete r[n];else if("object"===i){for(n in e)n in u||(r[n]=e[n]);void 0===r.slashes&&(r.slashes=a.test(e.href))}return r}function p(e){e=s(e);var t=i.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function f(e,t,n){if(e=s(e),!(this instanceof f))return new f(e,t,n);var a,i,l,u,m,h,g=c.slice(),y=typeof t,v=this,b=0;for("object"!==y&&"string"!==y&&(n=t,t=null),n&&"function"!=typeof n&&(n=r.parse),t=d(t),a=!(i=p(e||"")).protocol&&!i.slashes,v.slashes=i.slashes||a&&t.slashes,v.protocol=i.protocol||t.protocol||"",e=i.rest,i.slashes||(g[3]=[/(.*)/,"pathname"]);b<g.length;b++)"function"!=typeof(u=g[b])?(l=u[0],h=u[1],l!=l?v[h]=e:"string"==typeof l?~(m=e.indexOf(l))&&("number"==typeof u[2]?(v[h]=e.slice(0,m),e=e.slice(m+u[2])):(v[h]=e.slice(m),e=e.slice(0,m))):(m=l.exec(e))&&(v[h]=m[1],e=e.slice(0,m.index)),v[h]=v[h]||a&&u[3]&&t[h]||"",u[4]&&(v[h]=v[h].toLowerCase())):e=u(e);n&&(v.query=n(v.query)),a&&t.slashes&&"/"!==v.pathname.charAt(0)&&(""!==v.pathname||""!==t.pathname)&&(v.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),o=n.length,r=n[o-1],a=!1,i=0;o--;)"."===n[o]?n.splice(o,1):".."===n[o]?(n.splice(o,1),i++):i&&(0===o&&(a=!0),n.splice(o,1),i--);return a&&n.unshift(""),"."!==r&&".."!==r||n.push(""),n.join("/")}(v.pathname,t.pathname)),o(v.port,v.protocol)||(v.host=v.hostname,v.port=""),v.username=v.password="",v.auth&&(u=v.auth.split(":"),v.username=u[0]||"",v.password=u[1]||""),v.origin=v.protocol&&v.host&&"file:"!==v.protocol?v.protocol+"//"+v.host:"null",v.href=v.toString()}f.prototype={set:function(e,t,n){var a=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||r.parse)(t)),a[e]=t;break;case"port":a[e]=t,o(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="");break;case"hostname":a[e]=t,a.port&&(t+=":"+a.port),a.host=t;break;case"host":a[e]=t,/:\d+$/.test(t)?(t=t.split(":"),a.port=t.pop(),a.hostname=t.join(":")):(a.hostname=t,a.port="");break;case"protocol":a.protocol=t.toLowerCase(),a.slashes=!n;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";a[e]=t.charAt(0)!==i?i+t:t}else a[e]=t;break;default:a[e]=t}for(var l=0;l<c.length;l++){var s=c[l];s[4]&&(a[s[1]]=a[s[1]].toLowerCase())}return a.origin=a.protocol&&a.host&&"file:"!==a.protocol?a.protocol+"//"+a.host:"null",a.href=a.toString(),a},toString:function(e){e&&"function"==typeof e||(e=r.stringify);var t,n=this,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var a=o+(n.slashes?"//":"");return n.username&&(a+=n.username,n.password&&(a+=":"+n.password),a+="@"),a+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(a+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(a+=n.hash),a}},f.extractProtocol=p,f.location=d,f.trimLeft=s,f.qs=r,e.exports=f}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,n){"use strict";var o=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function a(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,r,i=[];for(r in"string"!=typeof t&&(t="?"),e)if(o.call(e,r)){if((n=e[r])||null!=n&&!isNaN(n)||(n=""),r=a(r),n=a(n),null===r||null===n)continue;i.push(r+"="+n)}return i.length?t+i.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,o={};t=n.exec(e);){var a=r(t[1]),i=r(t[2]);null===a||null===i||a in o||(o[a]=i)}return o}},function(e,t,n){"use strict";n.r(t);const o=(e,t,n,o)=>new Promise(r=>{t.forEach(t=>{const r=document.createElement("option");r.value=t[n],r.innerText=t[o],r.className="geolonia_address_"+e.name,e.appendChild(r)}),e.disabled=!1,r()}),r=(e,t,n)=>new Promise(o=>{t.forEach(t=>{const o=document.createElement("option");o.value=t[n],e.appendChild(o)}),o()}),a=e=>new Promise(t=>{[...e.children].forEach(e=>{const t=e;"true"!==(t.dataset||{}).isPlaceholder?t.remove():t.selected=!0}),t()}),i=(e,t)=>{e.className+=(e.className?" ":"")+"geolonia_address_wrap";e.innerHTML+=`\n    <button\n      id="geolonia-reverse-geocode-button"\n      type="button"\n    >${t.geolocationButtonLabel}</button>\n\n    <select\n      id="geolonia-pref-code"\n      name="${t.prefCodeName}"\n      class="geolonia_pref_select"\n      disabled\n    >\n      <option\n        data-is-placeholder="true"\n        selected\n        disabled\n      >${t.prefectureLabel}</option>\n    </select>\n\n    <input\n      id="geolonia-prefecture-name"\n      name="${t.prefectureName}"\n      type="hidden"\n    />\n\n    <select\n      id="geolonia-city-code"\n      name="${t.cityCodeName}"\n      class="geolonia_city_select"\n      disabled\n    >\n      <option\n        data-is-placeholder="true"\n        selected\n        disabled\n      >${t.cityLabel}</option>\n    </select>\n\n    <input\n      id="geolonia-city-name"\n      name="${t.cityName}"\n      type="hidden"\n    />\n\n    <input\n      id="geolonia-small-area"\n      name="${t.smallAreaName}"\n      class="geolonia_small_area_input"\n      type="text"\n      list="geolonia-small-area-datalist"\n      placeholder="${t.smallAreaLabel}"\n    />\n\n    <datalist id="geolonia-small-area-datalist"></datalist>\n\n    <input\n      id=geolonia-small-area-is-exception\n      name="${t.isSmallAreaExceptionName}"\n      type="hidden"\n    />\n\n    <input\n      id="geolonia-other-address"\n      name="${t.otherAddressName}"\n      class="geolonia_ither_address_input"\n      type="text"\n      placeholder="${t.otherAddressLabel}"\n    />\n\n    <div class="geolonia_error">\n      <span id="geolonia-error-message" />\n    </div>\n  `;const n=document.getElementById("geolonia-reverse-geocode-button"),o=document.querySelector("#geolonia-pref-code"),r=document.querySelector("#geolonia-prefecture-name"),a=document.querySelector("#geolonia-city-code"),i=document.querySelector("#geolonia-city-name"),l=document.querySelector("#geolonia-small-area"),s=document.querySelector("#geolonia-small-area-datalist"),c=document.querySelector("#geolonia-small-area-is-exception"),u=document.querySelector("#geolonia-other-address"),d=document.querySelector("#geolonia-error-message"),p=e.closest("form");return o.addEventListener("change",e=>{if(e.target instanceof HTMLSelectElement){d.innerText="";const t=e.target.value,n=[...document.querySelectorAll("#geolonia-pref-code option")].find(e=>e.value===t);n&&(r.value=n.innerText)}}),a.addEventListener("change",e=>{if(e.target instanceof HTMLSelectElement){d.innerText="";const t=e.target.value,n=[...document.querySelectorAll("#geolonia-city-code option")].find(e=>e.value===t);n&&(i.value=n.innerText)}}),l.addEventListener("change",e=>{if(e.target instanceof HTMLInputElement){d.innerText="";const t=e.target.value,n=[...document.querySelectorAll("#geolonia-small-area-datalist option")].find(e=>e.value===t);c.value=n?"false":"true"}}),u.addEventListener("change",e=>{d.innerText=""}),{buttonGeolocation:n,selectPrefCode:o,inputPrefName:r,selectCityCode:a,inputCityName:i,inputSmallArea:l,datalistSmallArea:s,inputIsSmallAreaException:c,spanErrorMessage:d,parentalForm:p}};var l=n(0),s=n.n(l);const c={geolocationButtonLabel:"現在地から住所を入力",geolocatingLabel:"取得中...",prefectureLabel:"都道府県",cityLabel:"市区町村",smallAreaLabel:"大字町丁目",otherAddressLabel:"その他の住所",prefectureName:"prefecture",prefCodeName:"pref-code",cityName:"city",cityCodeName:"city-code",smallAreaName:"small-area",isSmallAreaExceptionName:"is-exception",otherAddressName:"other-address"};var u=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}))};const d=e=>u(void 0,void 0,void 0,(function*(){try{return yield fetch("https://cdn.geolonia.com/address/"+e).then(e=>{if(e.status>299)throw console.error(e),new Error("request error");return e.json()})}catch(e){return null}})),p=e=>d(`japan/${e}.json`),f=(e,t)=>d(`japan/${e}/${t}.json`);var m=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}))};const h=e=>m(void 0,void 0,void 0,(function*(){const t=(e=>{let t;if(t=e instanceof HTMLElement?e:document.getElementById(e),!t)throw new Error("no target found.");return t})(e),n=(e=>{const t=e.dataset||{},n=Object.keys(t).reduce((e,n)=>(e[n]=escape(t[n]),e),{});return Object.assign(Object.assign({},c),n)})(t);let l=NaN,h=NaN,g="",y="";const[v,b]=yield Promise.all([i(t,n),d("japan.json")]),{buttonGeolocation:x,selectPrefCode:N,inputPrefName:w,selectCityCode:E,inputCityName:S,inputSmallArea:L,datalistSmallArea:A,inputIsSmallAreaException:T,spanErrorMessage:C,parentalForm:P}=v;if(!b)return void(C.innerText="何かのエラーです。住所データを取得できませんでした。");yield o(N,b,"都道府県コード","都道府県名"),x.addEventListener("click",()=>m(void 0,void 0,void 0,(function*(){x.innerText=n.geolocatingLabel;try{const e=yield new Promise((e,t)=>{window.navigator.geolocation.getCurrentPosition(t=>{const{latitude:n,longitude:o}=t.coords;e({lat:n,lng:o})},e=>t(e))});l=e.lat,h=e.lng}catch(e){return console.error(e),x.innerText=n.geolocationButtonLabel,void(C.innerText="現在位置から住所を取得できませんでした。")}const e=yield((e,t)=>u(void 0,void 0,void 0,(function*(){try{return yield fetch(`https://api.geolonia.com/dev/reverseGeocode?lng=${e}&lat=${t}`).then(e=>{if(e.status>299)throw console.error(e),new Error("request error");return e.json()})}catch(e){return null}})))(h,l);if(!e)return x.innerText=n.geolocationButtonLabel,void(C.innerText="何かのエラーです。現在位置から住所を取得できませんでした。");C.innerText="";const{PREF:t,CITY:i,S_NAME:s}=e;g=t,y=t+i;const[c,d]=yield Promise.all([p(g),f(g,y)]);if(!c||!d)return x.innerText=n.geolocationButtonLabel,void(C.innerText="何かのエラーです。住所データを取得できませんでした。");const m=b.find(e=>e.都道府県コード===g),v=c.find(e=>e.市区町村コード===y);m&&(w.value=m.都道府県名),v&&(S.value=v.市区町村名),yield Promise.all([a(E),a(A)]),yield Promise.all([o(E,c,"市区町村コード","市区町村名"),r(A,d,"大字町丁目名")]),N.value=g,E.value=y,L.value=s||"",T.value=d.find(e=>e.大字町丁目名===s)?"false":"true",x.innerText=n.geolocationButtonLabel})));N.addEventListener("change",e=>m(void 0,void 0,void 0,(function*(){if(e.target instanceof HTMLSelectElement){g=e.target.value;const t=yield p(g);if(!t)return void(C.innerText="何かのエラーです。住所データを取得できませんでした。");yield Promise.all([a(E),a(A)]),yield o(E,t,"市区町村コード","市区町村名")}}))),E.addEventListener("change",e=>m(void 0,void 0,void 0,(function*(){if(e.target instanceof HTMLSelectElement){y=e.target.value;const t=yield f(g,y);if(!t)return void(C.innerText="何かのエラーです。住所データを取得できませんでした。");yield a(A),yield r(A,t,"大字町丁目名")}}))),P&&P.addEventListener("submit",e=>{if(e.target instanceof HTMLFormElement&&!Number.isNaN(l)&&!Number.isNaN(h)){const t=new FormData(e.target),o=(()=>{const e=document.getElementsByTagName("script");for(const t of e){const{query:e}=s()(t.src)}return"YOUR-API-KEY"})();(({formData:e,lat:t,lng:n,apiKey:o},r)=>{const a=JSON.stringify({[c.prefCodeName]:e.get(r.prefCodeName),[c.prefectureName]:e.get(r.prefectureName),[c.cityName]:e.get(r.cityName),[c.cityCodeName]:e.get(r.cityCodeName),[c.smallAreaName]:e.get(r.smallAreaName),[c.otherAddressName]:e.get(r.otherAddressName),[c.isSmallAreaExceptionName]:e.get(r.isSmallAreaExceptionName),lat:t,lng:n});fetch("./",{method:"POST",headers:{"x-geolonia-api-key":o},body:a})})({formData:t,lat:l,lng:h,apiKey:o},n)}})})),g=document.getElementById("address");g&&h(g),window.geolonia||(window.geolonia={}),window.geolonia.address=h}]);